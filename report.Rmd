---
title: "CuocoBot1 build report"
author: "Michael Cuoco"
date: "`r Sys.Date()`"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
source("R/packages.R")
```

```{r get token}
token = if(ci_on_travis()){
  create_token(app = "cuoco-author-bot1",
               consumer_key = Sys.getenv("API_KEY"),
               consumer_secret = Sys.getenv("API_SKEY"),
               access_token = Sys.getenv("ACCESS_TOKEN"),
               access_secret = Sys.getenv("ACCESS_TOKEN_SEC"))
  } else{
    read_rds("rtweet_token.rds")
    }
```

```{r get pubs}
# Get last 100 tweets
all_df = readd(all_df)
head(all_df)
```

```{r tweet}
if(ci_on_travis()){tweet_pubs(all_df, token)}
ntweets = nrow(all_df)
print(glue("tweeted {nrow(all_df)} times"))
```

```{r 10 tweets}
top10 = get_timeline("CuocoBot1",token = token) %>% top_n(1, wt = created_at)
tweet_shot(top10$status_url[1])
```
